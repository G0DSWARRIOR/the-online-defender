<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Threat Defender</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <HTA:APPLICATION 
        ID="NetworkThreatDefender"
        APPLICATIONNAME="Network Threat Defender"
        BORDER="thin"
        BORDERSTYLE="normal"
        CAPTION="yes"
        ICON=""
        MAXIMIZEBUTTON="yes"
        MINIMIZEBUTTON="yes"
        SHOWINTASKBAR="yes"
        SINGLEINSTANCE="yes"
        SYSMENU="yes"
        WINDOWSTATE="normal"
    />
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f3f4f6;
        }
        .header-gradient {
            background: linear-gradient(135deg, #1e3a8a 0%, #2563eb 100%);
        }
        .threat-card {
            transition: all 0.3s ease;
        }
        .threat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .trusted-device {
            background-color: #f0fdf4;
            border-left: 4px solid #22c55e;
        }
        .blocked-device {
            background-color: #fef2f2;
            border-left: 4px solid #ef4444;
        }
    </style>
</head>
<body class="min-h-screen">
    <div class="flex flex-col min-h-screen">
        <!-- Header -->
        <header class="header-gradient text-white shadow-lg">
            <div class="container mx-auto px-4 py-6">
                <div class="flex justify-between items-center">
                    <div class="flex items-center space-x-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                        </svg>
                        <h1 class="text-2xl font-bold">Network Threat Defender</h1>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button id="scanBtn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                            </svg>
                            <span>Scan Network</span>
                        </button>
                        <button id="helpBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd" />
                            </svg>
                            <span>Help</span>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-grow container mx-auto px-4 py-6">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Left Column - Threat Detection -->
                <div class="lg:col-span-2 space-y-6">
                    <!-- Threat Summary Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-white rounded-lg shadow p-4 threat-card">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500">Active Threats</p>
                                    <h3 class="text-2xl font-bold text-red-500" id="activeThreats">0</h3>
                                </div>
                                <div class="bg-red-100 p-3 rounded-full">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-4 threat-card">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500">Blocked Threats</p>
                                    <h3 class="text-2xl font-bold text-green-500" id="blockedThreats">0</h3>
                                </div>
                                <div class="bg-green-100 p-3 rounded-full">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-4 threat-card">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500">Trusted Devices</p>
                                    <h3 class="text-2xl font-bold text-blue-500" id="trustedDevices">0</h3>
                                </div>
                                <div class="bg-blue-100 p-3 rounded-full">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Threat Activity Chart -->
                    <div class="bg-white rounded-lg shadow p-4">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-lg font-semibold">Threat Activity Over Time</h2>
                            <select id="timeRange" class="border rounded px-3 py-1 text-sm">
                                <option value="24h">Last 24 Hours</option>
                                <option value="7d">Last 7 Days</option>
                                <option value="30d">Last 30 Days</option>
                            </select>
                        </div>
                        <canvas id="threatChart" height="200"></canvas>
                    </div>

                    <!-- Detected Threats Table -->
                    <div class="bg-white rounded-lg shadow overflow-hidden">
                        <div class="px-4 py-3 border-b flex justify-between items-center">
                            <h2 class="text-lg font-semibold">Detected Threats</h2>
                            <button id="exportBtn" class="text-blue-500 hover:text-blue-700 text-sm flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                </svg>
                                Export Report
                            </button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">IP Address</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Location</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">First Seen</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Last Seen</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="threatsTable" class="bg-white divide-y divide-gray-200">
                                    <!-- Threats will be populated here -->
                                    <tr>
                                        <td colspan="5" class="px-6 py-4 text-center text-gray-500">No threats detected yet. Click "Scan Network" to begin.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Right Column - Trusted Devices & Quick Actions -->
                <div class="space-y-6">
                    <!-- Add Trusted Device -->
                    <div class="bg-white rounded-lg shadow p-4">
                        <h2 class="text-lg font-semibold mb-4">Add Trusted Device</h2>
                        <div class="space-y-4">
                            <div>
                                <label for="deviceName" class="block text-sm font-medium text-gray-700">Device Name</label>
                                <input type="text" id="deviceName" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div>
                                <label for="deviceIP" class="block text-sm font-medium text-gray-700">IP Address</label>
                                <input type="text" id="deviceIP" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="192.168.1.x">
                            </div>
                            <div>
                                <label for="deviceMAC" class="block text-sm font-medium text-gray-700">MAC Address (Optional)</label>
                                <input type="text" id="deviceMAC" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="00:1A:2B:3C:4D:5E">
                            </div>
                            <button id="addTrustedBtn" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-md transition-colors">Add to Trusted List</button>
                        </div>
                    </div>

                    <!-- Trusted Devices List -->
                    <div class="bg-white rounded-lg shadow">
                        <div class="px-4 py-3 border-b">
                            <h2 class="text-lg font-semibold">Trusted Devices</h2>
                        </div>
                        <div id="trustedDevicesList" class="divide-y divide-gray-200 max-h-96 overflow-y-auto">
                            <!-- Trusted devices will be populated here -->
                            <div class="px-4 py-3 text-center text-gray-500">No trusted devices added yet.</div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="bg-white rounded-lg shadow p-4">
                        <h2 class="text-lg font-semibold mb-4">Quick Actions</h2>
                        <div class="grid grid-cols-2 gap-3">
                            <button id="blockAllBtn" class="bg-red-500 hover:bg-red-600 text-white py-2 px-3 rounded-md text-sm flex items-center justify-center transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" />
                                </svg>
                                Block All Threats
                            </button>
                            <button id="clearTrustedBtn" class="bg-yellow-500 hover:bg-yellow-600 text-white py-2 px-3 rounded-md text-sm flex items-center justify-center transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                </svg>
                                Clear Trusted
                            </button>
                            <button id="viewLogsBtn" class="bg-gray-500 hover:bg-gray-600 text-white py-2 px-3 rounded-md text-sm flex items-center justify-center transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                </svg>
                                View Logs
                            </button>
                            <button id="settingsBtn" class="bg-purple-500 hover:bg-purple-600 text-white py-2 px-3 rounded-md text-sm flex items-center justify-center transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                </svg>
                                Settings
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-gray-800 text-white py-4">
            <div class="container mx-auto px-4 text-center text-sm">
                <p>Network Threat Defender v1.0 | © 2023 Security Solutions Inc. | <span id="lastScanTime">Last scan: Never</span></p>
            </div>
        </footer>
    </div>

    <!-- Modals -->
    <!-- Help Modal -->
    <div id="helpModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="px-6 py-4 border-b flex justify-between items-center">
                <h3 class="text-xl font-semibold">Help & Instructions</h3>
                <button id="closeHelpModal" class="text-gray-500 hover:text-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="p-6 space-y-4">
                <div>
                    <h4 class="font-medium text-lg mb-2">Getting Started</h4>
                    <p class="text-gray-600">Network Threat Defender helps you identify and block persistent threats on your network. Follow these simple steps to secure your network:</p>
                    <ol class="list-decimal list-inside mt-2 space-y-2 text-gray-600">
                        <li>Click "Scan Network" to begin detecting devices on your network</li>
                        <li>Review the detected threats in the table</li>
                        <li>Block suspicious devices by clicking the "Block" button</li>
                        <li>Add your trusted devices using the "Add Trusted Device" form</li>
                    </ol>
                </div>
                <div>
                    <h4 class="font-medium text-lg mb-2">Understanding the Interface</h4>
                    <ul class="list-disc list-inside space-y-2 text-gray-600">
                        <li><span class="font-medium">Active Threats:</span> Shows currently detected suspicious devices</li>
                        <li><span class="font-medium">Blocked Threats:</span> Count of devices you've blocked from your network</li>
                        <li><span class="font-medium">Trusted Devices:</span> Your approved devices that won't be flagged</li>
                        <li><span class="font-medium">Threat Activity Chart:</span> Visualizes threat patterns over time</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-medium text-lg mb-2">Best Practices</h4>
                    <ul class="list-disc list-inside space-y-2 text-gray-600">
                        <li>Scan your network regularly (at least once a day)</li>
                        <li>Review the location information of detected devices - foreign locations may indicate threats</li>
                        <li>Keep your trusted devices list updated</li>
                        <li>Use the "Export Report" feature to document threats for your records</li>
                    </ul>
                </div>
            </div>
            <div class="px-6 py-4 border-t flex justify-end">
                <button id="closeHelpModalBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-md transition-colors">Got It!</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto">
            <div class="px-6 py-4 border-b flex justify-between items-center">
                <h3 class="text-xl font-semibold">Settings</h3>
                <button id="closeSettingsModal" class="text-gray-500 hover:text-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="p-6 space-y-6">
                <div>
                    <h4 class="font-medium text-lg mb-4">Scan Settings</h4>
                    <div class="space-y-4">
                        <div>
                            <label class="flex items-center space-x-3">
                                <input type="checkbox" id="autoScan" class="form-checkbox h-5 w-5 text-blue-500 rounded">
                                <span class="text-gray-700">Enable automatic daily scans</span>
                            </label>
                        </div>
                        <div>
                            <label for="scanTime" class="block text-sm font-medium text-gray-700">Scheduled Scan Time</label>
                            <select id="scanTime" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                <option value="0">12:00 AM</option>
                                <option value="1">1:00 AM</option>
                                <option value="2">2:00 AM</option>
                                <option value="3">3:00 AM</option>
                                <option value="4">4:00 AM</option>
                                <option value="5">5:00 AM</option>
                                <option value="6">6:00 AM</option>
                                <option value="7">7:00 AM</option>
                                <option value="8" selected>8:00 AM</option>
                                <option value="9">9:00 AM</option>
                                <option value="10">10:00 AM</option>
                                <option value="11">11:00 AM</option>
                                <option value="12">12:00 PM</option>
                                <option value="13">1:00 PM</option>
                                <option value="14">2:00 PM</option>
                                <option value="15">3:00 PM</option>
                                <option value="16">4:00 PM</option>
                                <option value="17">5:00 PM</option>
                                <option value="18">6:00 PM</option>
                                <option value="19">7:00 PM</option>
                                <option value="20">8:00 PM</option>
                                <option value="21">9:00 PM</option>
                                <option value="22">10:00 PM</option>
                                <option value="23">11:00 PM</option>
                            </select>
                        </div>
                        <div>
                            <label for="scanDepth" class="block text-sm font-medium text-gray-700">Scan Intensity</label>
                            <select id="scanDepth" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                <option value="light">Light (Fast, basic detection)</option>
                                <option value="medium" selected>Medium (Balanced speed and depth)</option>
                                <option value="deep">Deep (Slower, thorough analysis)</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div>
                    <h4 class="font-medium text-lg mb-4">Notification Settings</h4>
                    <div class="space-y-4">
                        <div>
                            <label class="flex items-center space-x-3">
                                <input type="checkbox" id="notifyThreats" class="form-checkbox h-5 w-5 text-blue-500 rounded" checked>
                                <span class="text-gray-700">Notify when new threats are detected</span>
                            </label>
                        </div>
                        <div>
                            <label class="flex items-center space-x-3">
                                <input type="checkbox" id="notifyBlocked" class="form-checkbox h-5 w-5 text-blue-500 rounded" checked>
                                <span class="text-gray-700">Notify when threats are blocked</span>
                            </label>
                        </div>
                        <div>
                            <label for="notificationSound" class="block text-sm font-medium text-gray-700">Notification Sound</label>
                            <select id="notificationSound" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                <option value="default">Default</option>
                                <option value="alert">Alert</option>
                                <option value="chime">Chime</option>
                                <option value="none">None</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="px-6 py-4 border-t flex justify-between">
                <button id="resetSettingsBtn" class="text-gray-500 hover:text-gray-700 px-4 py-2 rounded-md">Reset to Defaults</button>
                <div class="space-x-3">
                    <button id="cancelSettingsBtn" class="border border-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-50">Cancel</button>
                    <button id="saveSettingsBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-md transition-colors">Save Settings</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Logs Modal -->
    <div id="logsModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col">
            <div class="px-6 py-4 border-b flex justify-between items-center">
                <h3 class="text-xl font-semibold">Security Logs</h3>
                <div class="flex items-center space-x-3">
                    <button id="refreshLogsBtn" class="text-blue-500 hover:text-blue-700 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                        </svg>
                        Refresh
                    </button>
                    <button id="closeLogsModal" class="text-gray-500 hover:text-gray-700">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
            </div>
            <div class="p-6 overflow-y-auto flex-grow">
                <div id="logsContainer" class="space-y-4">
                    <div class="bg-gray-50 p-4 rounded border-l-4 border-blue-500">
                        <div class="flex justify-between">
                            <span class="font-medium">System initialized</span>
                            <span class="text-sm text-gray-500">Just now</span>
                        </div>
                        <p class="text-sm text-gray-600 mt-1">Network Threat Defender is ready to scan your network.</p>
                    </div>
                </div>
            </div>
            <div class="px-6 py-4 border-t flex justify-between items-center">
                <div class="text-sm text-gray-500">
                    <span id="logCount">1</span> log entries
                </div>
                <button id="clearLogsBtn" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-md text-sm transition-colors">Clear All Logs</button>
            </div>
        </div>
    </div>

    <!-- Block Confirmation Modal -->
    <div id="blockConfirmModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md">
            <div class="px-6 py-4 border-b">
                <h3 class="text-xl font-semibold">Confirm Block</h3>
            </div>
            <div class="p-6">
                <p class="text-gray-600">Are you sure you want to block <span id="blockIP" class="font-medium"></span>?</p>
                <p class="text-gray-600 mt-2">This device will no longer be able to access your network.</p>
                <div class="mt-4">
                    <label class="flex items-center space-x-3">
                        <input type="checkbox" id="permanentBlock" class="form-checkbox h-5 w-5 text-blue-500 rounded">
                        <span class="text-gray-700">Permanently block this device</span>
                    </label>
                </div>
            </div>
            <div class="px-6 py-4 border-t flex justify-end space-x-3">
                <button id="cancelBlockBtn" class="border border-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-50">Cancel</button>
                <button id="confirmBlockBtn" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-md transition-colors">Block Device</button>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="notificationToast" class="fixed bottom-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center space-x-3 transform translate-y-10 opacity-0 transition-all duration-300 z-50 hidden">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <span id="toastMessage">Operation completed successfully</span>
        <button id="closeToast" class="text-white hover:text-gray-200">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
        </button>
    </div>

    <script>
        // Sample data for demonstration
        let threatsData = [];
        let trustedDevices = [];
        let logs = [
            { type: 'system', message: 'System initialized', details: 'Network Threat Defender is ready to scan your network.', timestamp: new Date() }
        ];
        let settings = {
            autoScan: false,
            scanTime: 8,
            scanDepth: 'medium',
            notifyThreats: true,
            notifyBlocked: true,
            notificationSound: 'default'
        };

        // DOM Elements
        const scanBtn = document.getElementById('scanBtn');
        const helpBtn = document.getElementById('helpBtn');
        const helpModal = document.getElementById('helpModal');
        const closeHelpModal = document.getElementById('closeHelpModal');
        const closeHelpModalBtn = document.getElementById('closeHelpModalBtn');
        const settingsBtn = document.getElementById('settingsBtn');
        const settingsModal = document.getElementById('settingsModal');
        const closeSettingsModal = document.getElementById('closeSettingsModal');
        const saveSettingsBtn = document.getElementById('saveSettingsBtn');
        const cancelSettingsBtn = document.getElementById('cancelSettingsBtn');
        const resetSettingsBtn = document.getElementById('resetSettingsBtn');
        const viewLogsBtn = document.getElementById('viewLogsBtn');
        const logsModal = document.getElementById('logsModal');
        const closeLogsModal = document.getElementById('closeLogsModal');
        const refreshLogsBtn = document.getElementById('refreshLogsBtn');
        const clearLogsBtn = document.getElementById('clearLogsBtn');
        const exportBtn = document.getElementById('exportBtn');
        const blockAllBtn = document.getElementById('blockAllBtn');
        const clearTrustedBtn = document.getElementById('clearTrustedBtn');
        const addTrustedBtn = document.getElementById('addTrustedBtn');
        const notificationToast = document.getElementById('notificationToast');
        const closeToast = document.getElementById('closeToast');
        const blockConfirmModal = document.getElementById('blockConfirmModal');
        const cancelBlockBtn = document.getElementById('cancelBlockBtn');
        const confirmBlockBtn = document.getElementById('confirmBlockBtn');
        const blockIP = document.getElementById('blockIP');

        // Chart initialization
        let threatChart;
        function initChart() {
            const ctx = document.getElementById('threatChart').getContext('2d');
            threatChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array(24).fill().map((_, i) => `${i}:00`),
                    datasets: [
                        {
                            label: 'Threat Activity',
                            data: Array(24).fill().map(() => Math.floor(Math.random() * 5)),
                            borderColor: '#ef4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            tension: 0.3,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                precision: 0
                            }
                        }
                    }
                }
            });
        }

        // Update chart data
        function updateChart() {
            const timeRange = document.getElementById('timeRange').value;
            let labels, data;
            
            if (timeRange === '24h') {
                labels = Array(24).fill().map((_, i) => `${i}:00`);
                data = Array(24).fill().map(() => Math.floor(Math.random() * 5));
            } else if (timeRange === '7d') {
                labels = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
                data = labels.map(() => Math.floor(Math.random() * 10));
            } else {
                labels = Array(30).fill().map((_, i) => `Day ${i + 1}`);
                data = labels.map(() => Math.floor(Math.random() * 15));
            }
            
            threatChart.data.labels = labels;
            threatChart.data.datasets[0].data = data;
            threatChart.update();
        }

        // Generate random IP for demo
        function randomIP() {
            return `192.168.1.${Math.floor(Math.random() * 255)}`;
        }

        // Generate random location for demo
        function randomLocation() {
            const cities = [
                'Beijing, China', 'Moscow, Russia', 'Tehran, Iran', 
                'Pyongyang, North Korea', 'Kinshasa, Congo', 
                'Caracas, Venezuela', 'Havana, Cuba', 'New York, USA',
                'London, UK', 'Paris, France', 'Berlin, Germany'
            ];
            return cities[Math.floor(Math.random() * cities.length)];
        }

        // Generate random date for demo
        function randomDate() {
            const now = new Date();
            const past = new Date(now);
            past.setDate(past.getDate() - Math.floor(Math.random() * 30));
            return past.toLocaleString();
        }

        // Scan network - demo function
        function scanNetwork() {
            // Show loading state
            scanBtn.innerHTML = `
                <svg class="animate-spin -ml-1 mr-2 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Scanning...
            `;
            scanBtn.disabled = true;

            // Simulate network scan
            setTimeout(() => {
                // Generate some random threats for demo
                const newThreats = Array(Math.floor(Math.random() * 5) + 1).fill().map(() => ({
                    ip: randomIP(),
                    location: randomLocation(),
                    firstSeen: randomDate(),
                    lastSeen: new Date().toLocaleString(),
                    status: 'active'
                }));

                // Add to existing threats if not already there
                newThreats.forEach(threat => {
                    if (!threatsData.some(t => t.ip === threat.ip)) {
                        threatsData.push(threat);
                    }
                });

                // Update UI
                updateThreatsTable();
                updateCounters();
                updateLastScanTime();

                // Add log entry
                addLog('scan', `Network scan completed. Found ${newThreats.length} potential threats.`);

                // Show notification
                showNotification(`Scan completed. Found ${newThreats.length} potential threats.`);

                // Reset button
                scanBtn.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 
</html>